{% extends "base.html" %}
{% load humanize %}
{% block title %}Ventes{% endblock %}
{% block page_title %}Ventes & cession{% endblock %}
{% block content %}
<div class="card">
  <h2 class="card-title">Ventes & cession</h2>
  <p class="card-desc">Historique des ventes — acquéreur, prix, km à la vente, garantie, état livraison.</p>
</div>
<div class="card card-table">
  <div class="table-filter-wrap">
    <span class="table-filter-label">Filtrer les ventes :</span>
    <input type="search" class="table-filter-input" placeholder="Rechercher dans le tableau" data-table-filter="table-ventes">
  </div>
  <table class="table" id="table-ventes">
    <thead>
      <tr>
        <th>Véhicule</th>
        <th>Date vente</th>
        <th>Acquéreur</th>
        <th>Prix vente (FCFA)</th>
        <th>Km vente</th>
        <th>Garantie</th>
        <th>État livraison</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for v in ventes %}
      <tr>
        <td><strong><a href="{% url 'flotte:vehicule_detail' v.vehicule.pk %}">{{ v.vehicule.libelle_court }}</a></strong></td>
        <td>{{ v.date_vente }}</td>
        <td>{{ v.acquereur|default:"—" }}</td>
        <td class="num">{% if v.prix_vente %}<span class="montant-fcfa" data-montant="{{ v.prix_vente|floatformat:0 }}">{{ v.prix_vente|floatformat:0 }}</span>{% else %}—{% endif %}</td>
        <td>{{ v.km_vente|default:"—"|intcomma }}</td>
        <td>{{ v.garantie_duree|default:"—" }}</td>
        <td>{{ v.etat_livraison|default:"—" }}</td>
        <td><a href="{% url 'flotte:vehicule_detail' v.vehicule.pk %}" class="btn btn-ghost btn-sm">Fiche</a></td>
      </tr>
      {% empty %}
      <tr><td colspan="8">Aucune vente enregistrée.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
